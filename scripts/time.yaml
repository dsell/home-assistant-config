say_time:
  alias: Say Time
  sequence:
    - service: shell_command.say
      data_template:
        message: >
          'The time is now
          {% set minute = now().strftime("%M")|int %}
          {% set hour = now().strftime("%H")|int %}
          {% if hour > 12 %}
            {% set PM = true %}
            {% set hour = hour - 12 %}
          {% elif hour == 12 %}
            {% if minute > 0 %}
              {% set PM = true %}
            {% endif %}
          {% endif %}
          {{ hour }} 
          {% if minute < 10 %}
            Ohh
          {% endif %}
          {{ minute }}
          {% if PM == true %}
            Pee eM
          {% else %}
            Ayy eM
          {% endif %}'
        dest_id: default